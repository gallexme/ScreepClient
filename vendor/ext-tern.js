ace.define("ace/snippets",["require","exports","module","ace/lib/oop","ace/lib/event_emitter","ace/lib/lang","ace/range","ace/anchor","ace/keyboard/hash_handler","ace/tokenizer","ace/lib/dom","ace/editor"],function(a,b,c){"use strict";var d=a("./lib/oop"),e=a("./lib/event_emitter").EventEmitter,f=a("./lib/lang"),g=a("./range").Range,h=a("./anchor").Anchor,i=a("./keyboard/hash_handler").HashHandler,j=a("./tokenizer").Tokenizer,k=g.comparePoints,l=function(){this.snippetMap={},this.snippetNameMap={}};(function(){d.implement(this,e),this.getTokenizer=function(){function a(a,b,c){return a=a.substr(1),/^\d+$/.test(a)&&!c.inFormatString?[{tabstopId:parseInt(a,10)}]:[{text:a}]}function b(a){return"(?:[^\\\\"+a+"]|\\\\.)"}return l.$tokenizer=new j({start:[{regex:/:/,onMatch:function(a,b,c){return c.length&&c[0].expectIf?(c[0].expectIf=!1,c[0].elseBranch=c[0],[c[0]]):":"}},{regex:/\\./,onMatch:function(a,b,c){var d=a[1];return"}"==d&&c.length?a=d:-1!="`$\\".indexOf(d)?a=d:c.inFormatString&&("n"==d?a="\n":"t"==d?a="\n":-1!="ulULE".indexOf(d)&&(a={changeCase:d,local:d>"a"})),[a]}},{regex:/}/,onMatch:function(a,b,c){return[c.length?c.shift():a]}},{regex:/\$(?:\d+|\w+)/,onMatch:a},{regex:/\$\{[\dA-Z_a-z]+/,onMatch:function(b,c,d){var e=a(b.substr(1),c,d);return d.unshift(e[0]),e},next:"snippetVar"},{regex:/\n/,token:"newline",merge:!1}],snippetVar:[{regex:"\\|"+b("\\|")+"*\\|",onMatch:function(a,b,c){c[0].choices=a.slice(1,-1).split(",")},next:"start"},{regex:"/("+b("/")+"+)/(?:("+b("/")+"*)/)(\\w*):?",onMatch:function(a,b,c){var d=c[0];return d.fmtString=a,a=this.splitRegex.exec(a),d.guard=a[1],d.fmt=a[2],d.flag=a[3],""},next:"start"},{regex:"`"+b("`")+"*`",onMatch:function(a,b,c){return c[0].code=a.splice(1,-1),""},next:"start"},{regex:"\\?",onMatch:function(a,b,c){c[0]&&(c[0].expectIf=!0)},next:"start"},{regex:"([^:}\\\\]|\\\\.)*:?",token:"",next:"start"}],formatString:[{regex:"/("+b("/")+"+)/",token:"regex"},{regex:"",onMatch:function(a,b,c){c.inFormatString=!0},next:"start"}]}),l.prototype.getTokenizer=function(){return l.$tokenizer},l.$tokenizer},this.tokenizeTmSnippet=function(a,b){return this.getTokenizer().getLineTokens(a,b).tokens.map(function(a){return a.value||a})},this.$getDefaultValue=function(a,b){if(/^[A-Z]\d+$/.test(b)){var c=b.substr(1);return(this.variables[b[0]+"__"]||{})[c]}if(/^\d+$/.test(b))return(this.variables.__||{})[b];if(b=b.replace(/^TM_/,""),a){var d=a.session;switch(b){case"CURRENT_WORD":var e=d.getWordRange();case"SELECTION":case"SELECTED_TEXT":return d.getTextRange(e);case"CURRENT_LINE":return d.getLine(a.getCursorPosition().row);case"PREV_LINE":return d.getLine(a.getCursorPosition().row-1);case"LINE_INDEX":return a.getCursorPosition().column;case"LINE_NUMBER":return a.getCursorPosition().row+1;case"SOFT_TABS":return d.getUseSoftTabs()?"YES":"NO";case"TAB_SIZE":return d.getTabSize();case"FILENAME":case"FILEPATH":return"";case"FULLNAME":return"Ace"}}},this.variables={},this.getVariableValue=function(a,b){return this.variables.hasOwnProperty(b)?this.variables[b](a,b)||"":this.$getDefaultValue(a,b)||""},this.tmStrFormat=function(a,b,c){var d=b.flag||"",e=b.guard;e=new RegExp(e,d.replace(/[^gi]/,""));var f=this.tokenizeTmSnippet(b.fmt,"formatString"),g=this,h=a.replace(e,function(){g.variables.__=arguments;for(var a=g.resolveVariables(f,c),b="E",d=0;d<a.length;d++){var e=a[d];if("object"==typeof e)if(a[d]="",e.changeCase&&e.local){var h=a[d+1];h&&"string"==typeof h&&("u"==e.changeCase?a[d]=h[0].toUpperCase():a[d]=h[0].toLowerCase(),a[d+1]=h.substr(1))}else e.changeCase&&(b=e.changeCase);else"U"==b?a[d]=e.toUpperCase():"L"==b&&(a[d]=e.toLowerCase())}return a.join("")});return this.variables.__=null,h},this.resolveVariables=function(a,b){function c(b){var c=a.indexOf(b,e+1);-1!=c&&(e=c)}for(var d=[],e=0;e<a.length;e++){var f=a[e];if("string"==typeof f)d.push(f);else{if("object"!=typeof f)continue;if(f.skip)c(f);else{if(f.processed<e)continue;if(f.text){var g=this.getVariableValue(b,f.text);g&&f.fmtString&&(g=this.tmStrFormat(g,f)),f.processed=e,null==f.expectIf?g&&(d.push(g),c(f)):g?f.skip=f.elseBranch:c(f)}else null!=f.tabstopId?d.push(f):null!=f.changeCase&&d.push(f)}}}return d},this.insertSnippetForSelection=function(a,b){function c(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];if("object"==typeof d){if(j[d.tabstopId])continue;var e=a.lastIndexOf(d,c-1);d=b[e]||{tabstopId:d.tabstopId}}b[c]=d}return b}var d=a.getCursorPosition(),e=a.session.getLine(d.row),f=a.session.getTabString(),g=e.match(/^\s*/)[0];d.column<g.length&&(g=g.slice(0,d.column));var h=this.tokenizeTmSnippet(b);h=this.resolveVariables(h,a),h=h.map(function(a){return"\n"==a?a+g:"string"==typeof a?a.replace(/\t/g,f):a});var i=[];h.forEach(function(a,b){if("object"==typeof a){var c=a.tabstopId,d=i[c];if(d||(d=i[c]=[],d.index=c,d.value=""),-1===d.indexOf(a)){d.push(a);var e=h.indexOf(a,b+1);if(-1!==e){var f=h.slice(b+1,e),g=f.some(function(a){return"object"==typeof a});g&&!d.value?d.value=f:!f.length||d.value&&"string"==typeof d.value||(d.value=f.join(""))}}}}),i.forEach(function(a){a.length=0});for(var j={},k=0;k<h.length;k++){var l=h[k];if("object"==typeof l){var n=l.tabstopId,o=h.indexOf(l,k+1);if(j[n])j[n]===l&&(j[n]=null);else{var p=i[n],q="string"==typeof p.value?[p.value]:c(p.value);q.unshift(k+1,Math.max(0,o-k)),q.push(l),j[n]=l,h.splice.apply(h,q),-1===p.indexOf(l)&&p.push(l)}}}var r=0,s=0,t="";h.forEach(function(a){"string"==typeof a?("\n"===a[0]?(s=a.length-1,r++):s+=a.length,t+=a):a.start?a.end={row:r,column:s}:a.start={row:r,column:s}});var u=a.getSelectionRange(),v=a.session.replace(u,t),w=new m(a),x=a.inVirtualSelectionMode&&a.selection.index;w.addTabstops(i,u.start,v,x)},this.insertSnippet=function(a,b){var c=this;return a.inVirtualSelectionMode?c.insertSnippetForSelection(a,b):(a.forEachSelection(function(){c.insertSnippetForSelection(a,b)},null,{keepOrder:!0}),void(a.tabstopManager&&a.tabstopManager.tabNext()))},this.$getScope=function(a){var b=a.session.$mode.$id||"";if(b=b.split("/").pop(),"html"===b||"php"===b){"php"!==b||a.session.$mode.inlinePhp||(b="html");var c=a.getCursorPosition(),d=a.session.getState(c.row);"object"==typeof d&&(d=d[0]),d.substring&&("js-"==d.substring(0,3)?b="javascript":"css-"==d.substring(0,4)?b="css":"php-"==d.substring(0,4)&&(b="php"))}return b},this.getActiveScopes=function(a){var b=this.$getScope(a),c=[b],d=this.snippetMap;return d[b]&&d[b].includeScopes&&c.push.apply(c,d[b].includeScopes),c.push("_"),c},this.expandWithTab=function(a,b){var c=this,d=a.forEachSelection(function(){return c.expandSnippetForSelection(a,b)},null,{keepOrder:!0});return d&&a.tabstopManager&&a.tabstopManager.tabNext(),d},this.expandSnippetForSelection=function(a,b){var c,d=a.getCursorPosition(),e=a.session.getLine(d.row),f=e.substring(0,d.column),g=e.substr(d.column),h=this.snippetMap;return this.getActiveScopes(a).some(function(a){var b=h[a];return b&&(c=this.findMatchingSnippet(b,f,g)),!!c},this),c?b&&b.dryRun?!0:(a.session.doc.removeInLine(d.row,d.column-c.replaceBefore.length,d.column+c.replaceAfter.length),this.variables.M__=c.matchBefore,this.variables.T__=c.matchAfter,this.insertSnippetForSelection(a,c.content),this.variables.M__=this.variables.T__=null,!0):!1},this.findMatchingSnippet=function(a,b,c){for(var d=a.length;d--;){var e=a[d];if((!e.startRe||e.startRe.test(b))&&(!e.endRe||e.endRe.test(c))&&(e.startRe||e.endRe))return e.matchBefore=e.startRe?e.startRe.exec(b):[""],e.matchAfter=e.endRe?e.endRe.exec(c):[""],e.replaceBefore=e.triggerRe?e.triggerRe.exec(b)[0]:"",e.replaceAfter=e.endTriggerRe?e.endTriggerRe.exec(c)[0]:"",e}},this.snippetMap={},this.snippetNameMap={},this.register=function(a,b){function c(a){return a&&!/^\^?\(.*\)\$?$|^\\b$/.test(a)&&(a="(?:"+a+")"),a||""}function d(a,b,d){return a=c(a),b=c(b),d?(a=b+a,a&&"$"!=a[a.length-1]&&(a+="$")):(a+=b,a&&"^"!=a[0]&&(a="^"+a)),new RegExp(a)}function e(a){a.scope||(a.scope=b||"_"),b=a.scope,g[b]||(g[b]=[],h[b]={});var c=h[b];if(a.name){var e=c[a.name];e&&i.unregister(e),c[a.name]=a}g[b].push(a),a.tabTrigger&&!a.trigger&&(!a.guard&&/^\w/.test(a.tabTrigger)&&(a.guard="\\b"),a.trigger=f.escapeRegExp(a.tabTrigger)),a.startRe=d(a.trigger,a.guard,!0),a.triggerRe=new RegExp(a.trigger,"",!0),a.endRe=d(a.endTrigger,a.endGuard,!0),a.endTriggerRe=new RegExp(a.endTrigger,"",!0)}var g=this.snippetMap,h=this.snippetNameMap,i=this;a||(a=[]),a&&a.content?e(a):Array.isArray(a)&&a.forEach(e),this._signal("registerSnippets",{scope:b})},this.unregister=function(a,b){function c(a){var c=e[a.scope||b];if(c&&c[a.name]){delete c[a.name];var f=d[a.scope||b],g=f&&f.indexOf(a);g>=0&&f.splice(g,1)}}var d=this.snippetMap,e=this.snippetNameMap;a.content?c(a):Array.isArray(a)&&a.forEach(c)},this.parseSnippetFile=function(a){a=a.replace(/\r/g,"");for(var b,c=[],d={},e=/^#.*|^({[\s\S]*})\s*$|^(\S+) (.*)$|^((?:\n*\t.*)+)/gm;b=e.exec(a);){if(b[1])try{d=JSON.parse(b[1]),c.push(d)}catch(f){}if(b[4])d.content=b[4].replace(/^\t/gm,""),c.push(d),d={};else{var g=b[2],h=b[3];if("regex"==g){var i=/\/((?:[^\/\\]|\\.)*)|$/g;d.guard=i.exec(h)[1],d.trigger=i.exec(h)[1],d.endTrigger=i.exec(h)[1],d.endGuard=i.exec(h)[1]}else"snippet"==g?(d.tabTrigger=h.match(/^\S*/)[0],d.name||(d.name=h)):d[g]=h}}return c},this.getSnippetByName=function(a,b){var c,d=this.snippetNameMap;return this.getActiveScopes(b).some(function(b){var e=d[b];return e&&(c=e[a]),!!c},this),c}}).call(l.prototype);var m=function(a){return a.tabstopManager?a.tabstopManager:(a.tabstopManager=this,this.$onChange=this.onChange.bind(this),this.$onChangeSelection=f.delayedCall(this.onChangeSelection.bind(this)).schedule,this.$onChangeSession=this.onChangeSession.bind(this),this.$onAfterExec=this.onAfterExec.bind(this),void this.attach(a))};(function(){this.attach=function(a){this.index=0,this.ranges=[],this.tabstops=[],this.$openTabstops=null,this.selectedTabstop=null,this.editor=a,this.editor.on("change",this.$onChange),this.editor.on("changeSelection",this.$onChangeSelection),this.editor.on("changeSession",this.$onChangeSession),this.editor.commands.on("afterExec",this.$onAfterExec),this.editor.keyBinding.addKeyboardHandler(this.keyboardHandler)},this.detach=function(){this.tabstops.forEach(this.removeTabstopMarkers,this),this.ranges=null,this.tabstops=null,this.selectedTabstop=null,this.editor.removeListener("change",this.$onChange),this.editor.removeListener("changeSelection",this.$onChangeSelection),this.editor.removeListener("changeSession",this.$onChangeSession),this.editor.commands.removeListener("afterExec",this.$onAfterExec),this.editor.keyBinding.removeKeyboardHandler(this.keyboardHandler),this.editor.tabstopManager=null,this.editor=null},this.onChange=function(a){var b=a.data.range,c="r"==a.data.action[0],d=b.start,e=b.end,f=d.row,g=e.row,h=g-f,i=e.column-d.column;if(c&&(h=-h,i=-i),!this.$inChange&&c){var j=this.selectedTabstop,l=j&&!j.some(function(a){return k(a.start,d)<=0&&k(a.end,e)>=0});if(l)return this.detach()}for(var m=this.ranges,n=0;n<m.length;n++){var o=m[n];o.end.row<d.row||(c&&k(d,o.start)<0&&k(e,o.end)>0?(this.removeRange(o),n--):(o.start.row==f&&o.start.column>d.column&&(o.start.column+=i),o.end.row==f&&o.end.column>=d.column&&(o.end.column+=i),o.start.row>=f&&(o.start.row+=h),o.end.row>=f&&(o.end.row+=h),k(o.start,o.end)>0&&this.removeRange(o)))}m.length||this.detach()},this.updateLinkedFields=function(){var a=this.selectedTabstop;if(a&&a.hasLinkedRanges){this.$inChange=!0;for(var c=this.editor.session,d=c.getTextRange(a.firstNonLinked),e=a.length;e--;){var f=a[e];if(f.linked){var g=b.snippetManager.tmStrFormat(d,f.original);c.replace(f,g)}}this.$inChange=!1}},this.onAfterExec=function(a){a.command&&!a.command.readOnly&&this.updateLinkedFields()},this.onChangeSelection=function(){if(this.editor){for(var a=this.editor.selection.lead,b=this.editor.selection.anchor,c=this.editor.selection.isEmpty(),d=this.ranges.length;d--;)if(!this.ranges[d].linked){var e=this.ranges[d].contains(a.row,a.column),f=c||this.ranges[d].contains(b.row,b.column);if(e&&f)return}this.detach()}},this.onChangeSession=function(){this.detach()},this.tabNext=function(a){var b=this.tabstops.length,c=this.index+(a||1);c=Math.min(Math.max(c,1),b),c==b&&(c=0),this.selectTabstop(c),0===c&&this.detach()},this.selectTabstop=function(a){this.$openTabstops=null;var b=this.tabstops[this.index];if(b&&this.addTabstopMarkers(b),this.index=a,b=this.tabstops[this.index],b&&b.length){if(this.selectedTabstop=b,this.editor.inVirtualSelectionMode)this.editor.selection.setRange(b.firstNonLinked);else{var c=this.editor.multiSelect;c.toSingleRange(b.firstNonLinked.clone());for(var d=b.length;d--;)b.hasLinkedRanges&&b[d].linked||c.addRange(b[d].clone(),!0);c.ranges[0]&&c.addRange(c.ranges[0].clone())}this.editor.keyBinding.addKeyboardHandler(this.keyboardHandler)}},this.addTabstops=function(a,b,c){if(this.$openTabstops||(this.$openTabstops=[]),!a[0]){var d=g.fromPoints(c,c);p(d.start,b),p(d.end,b),a[0]=[d],a[0].index=0}var e=this.index,f=[e+1,0],h=this.ranges;a.forEach(function(a,c){for(var d=this.$openTabstops[c]||a,e=a.length;e--;){var i=a[e],j=g.fromPoints(i.start,i.end||i.start);o(j.start,b),o(j.end,b),j.original=i,j.tabstop=d,h.push(j),d!=a?d.unshift(j):d[e]=j,i.fmtString?(j.linked=!0,d.hasLinkedRanges=!0):d.firstNonLinked||(d.firstNonLinked=j)}d.firstNonLinked||(d.hasLinkedRanges=!1),d===a&&(f.push(d),this.$openTabstops[c]=d),this.addTabstopMarkers(d)},this),f.length>2&&(this.tabstops.length&&f.push(f.splice(2,1)[0]),this.tabstops.splice.apply(this.tabstops,f))},this.addTabstopMarkers=function(a){var b=this.editor.session;a.forEach(function(a){a.markerId||(a.markerId=b.addMarker(a,"ace_snippet-marker","text"))})},this.removeTabstopMarkers=function(a){var b=this.editor.session;a.forEach(function(a){b.removeMarker(a.markerId),a.markerId=null})},this.removeRange=function(a){var b=a.tabstop.indexOf(a);a.tabstop.splice(b,1),b=this.ranges.indexOf(a),this.ranges.splice(b,1),this.editor.session.removeMarker(a.markerId),a.tabstop.length||(b=this.tabstops.indexOf(a.tabstop),-1!=b&&this.tabstops.splice(b,1),this.tabstops.length||this.detach())},this.keyboardHandler=new i,this.keyboardHandler.bindKeys({Tab:function(a){b.snippetManager&&b.snippetManager.expandWithTab(a)||a.tabstopManager.tabNext(1)},"Shift-Tab":function(a){a.tabstopManager.tabNext(-1)},Esc:function(a){a.tabstopManager.detach()},Return:function(a){return!1}})}).call(m.prototype);var n={};n.onChange=h.prototype.onChange,n.setPosition=function(a,b){this.pos.row=a,this.pos.column=b},n.update=function(a,b,c){this.$insertRight=c,this.pos=a,this.onChange(b)};var o=function(a,b){0==a.row&&(a.column+=b.column),a.row+=b.row},p=function(a,b){a.row==b.row&&(a.column-=b.column),a.row-=b.row};a("./lib/dom").importCssString(".ace_snippet-marker {    -moz-box-sizing: border-box;    box-sizing: border-box;    background: rgba(194, 193, 208, 0.09);    border: 1px dotted rgba(211, 208, 235, 0.62);    position: absolute;}"),b.snippetManager=new l;var q=a("./editor").Editor;(function(){this.insertSnippet=function(a,c){return b.snippetManager.insertSnippet(this,a,c)},this.expandSnippet=function(a){return b.snippetManager.expandWithTab(this,a)}}).call(q.prototype)}),ace.define("ace/autocomplete/text_completer",["require","exports","module","ace/range"],function(a,b,c){function d(a,b){var c=a.getTextRange(f.fromPoints({row:0,column:0},b));return c.split(g).length-1}function e(a,b){var c=d(a,b),e=a.getValue().split(g),f=Object.create(null),h=e[c];return e.forEach(function(a,b){if(a&&a!==h){var d=Math.abs(c-b),g=e.length-d;f[a]?f[a]=Math.max(g,f[a]):f[a]=g}}),f}var f=a("../range").Range,g=/[^a-zA-Z_0-9\$\-\u00C0-\u1FFF\u2C00-\uD7FF\w]+/;b.getCompletions=function(a,b,c,d,f){var g=e(b,c,d),h=Object.keys(g);f(null,h.map(function(a){return{caption:a,value:a,score:g[a],meta:"local"}}))}}),ace.define("ace/autocomplete/popup",["require","exports","module","ace/edit_session","ace/virtual_renderer","ace/editor","ace/range","ace/lib/event","ace/lib/lang","ace/lib/dom"],function(a,b,c){"use strict";var d=(a("../edit_session").EditSession,a("../virtual_renderer").VirtualRenderer),e=a("../editor").Editor,f=a("../range").Range,g=a("../lib/event"),h=a("../lib/lang"),i=a("../lib/dom"),j=function(a){var b=new d(a);b.$maxLines=4;var c=new e(b);return c.setHighlightActiveLine(!1),c.setShowPrintMargin(!1),c.renderer.setShowGutter(!1),c.renderer.setHighlightGutterLine(!1),c.$mouseHandler.$focusWaitTimout=0,c.$highlightTagPending=!0,c},k=function(a){var b=i.createElement("div"),c=new j(b);a&&a.appendChild(b),b.style.display="none",c.renderer.content.style.cursor="default",c.renderer.setStyle("ace_autocomplete"),c.setOption("displayIndentGuides",!1),c.setOption("dragDelay",150);var d=function(){};c.focus=d,c.$isFocused=!0,c.renderer.$cursorLayer.restartTimer=d,c.renderer.$cursorLayer.element.style.opacity=0,c.renderer.$maxLines=8,c.renderer.$keepTextAreaAtCursor=!1,c.setHighlightActiveLine(!1),c.session.highlight(""),c.session.$searchHighlight.clazz="ace_highlight-marker",c.on("mousedown",function(a){var b=a.getDocumentPosition();c.selection.moveToPosition(b),l.start.row=l.end.row=b.row,a.stop()});var e,k=new f(-1,0,-1,1/0),l=new f(-1,0,-1,1/0);l.id=c.session.addMarker(l,"ace_active-line","fullLine"),c.setSelectOnHover=function(a){a?k.id&&(c.session.removeMarker(k.id),k.id=null):k.id=c.session.addMarker(k,"ace_line-hover","fullLine")},c.setSelectOnHover(!1),c.on("mousemove",function(a){if(!e)return void(e=a);if(e.x!=a.x||e.y!=a.y){e=a,e.scrollTop=c.renderer.scrollTop;var b=e.getDocumentPosition().row;k.start.row!=b&&(k.id||c.setRow(b),n(b))}}),c.renderer.on("beforeRender",function(){if(e&&-1!=k.start.row){e.$pos=null;var a=e.getDocumentPosition().row;k.id||c.setRow(a),n(a,!0)}}),c.renderer.on("afterRender",function(){var a=c.getRow(),b=c.renderer.$textLayer,d=b.element.childNodes[a-b.config.firstRow];d!=b.selectedNode&&(b.selectedNode&&i.removeCssClass(b.selectedNode,"ace_selected"),b.selectedNode=d,d&&i.addCssClass(d,"ace_selected"))});var m=function(){n(-1)},n=function(a,b){a!==k.start.row&&(k.start.row=k.end.row=a,b||c.session._emit("changeBackMarker"),c._emit("changeHoverMarker"))};c.getHoveredRow=function(){return k.start.row},g.addListener(c.container,"mouseout",m),c.on("hide",m),c.on("changeSelection",m),c.session.doc.getLength=function(){return c.data.length},c.session.doc.getLine=function(a){var b=c.data[a];return"string"==typeof b?b:b&&b.value||""};var o=c.session.bgTokenizer;return o.$tokenizeRow=function(a){var b=c.data[a],d=[];if(!b)return d;"string"==typeof b&&(b={value:b}),b.caption||(b.caption=b.value||b.name);var e,f,g=-1;b.iconClass&&d.push({type:b.iconClass,value:" "});for(var h=0;h<b.caption.length;h++)f=b.caption[h],e=b.matchMask&1<<h?1:0,g!==e?(d.push({type:b.className||""+(e?"completion-highlight":""),value:f}),g=e):d[d.length-1].value+=f;if(b.meta){var i=c.renderer.$size.scrollerWidth/c.renderer.layerConfig.characterWidth,j=b.meta;j.length+b.caption.length>i-2&&(j=j.substr(0,i-b.caption.length-3)+"…"),d.push({type:"rightAlignedText",value:j})}return d},o.$updateOnChange=d,o.start=d,c.session.$computeWidth=function(){return this.screenWidth=0},c.$blockScrolling=1/0,c.isOpen=!1,c.isTopdown=!1,c.data=[],c.setData=function(a){c.data=a||[],c.setValue(h.stringRepeat("\n",a.length),-1),c.setRow(0)},c.getData=function(a){return c.data[a]},c.getRow=function(){return l.start.row},c.setRow=function(a){a=Math.max(-1,Math.min(this.data.length,a)),l.start.row!=a&&(c.selection.clearSelection(),l.start.row=l.end.row=a||0,c.session._emit("changeBackMarker"),c.moveCursorTo(a||0,0),c.isOpen&&c._signal("select"))},c.on("changeSelection",function(){c.isOpen&&c.setRow(c.selection.lead.row),c.renderer.scrollCursorIntoView()}),c.hide=function(){this.container.style.display="none",this._signal("hide"),c.isOpen=!1},c.show=function(a,b,d){var f=this.container,g=window.innerHeight,h=window.innerWidth,i=this.renderer,j=i.$maxLines*b*1.4,k=a.top+this.$borderSize;k+j>g-b&&!d?(f.style.top="",f.style.bottom=g-k+"px",c.isTopdown=!1):(k+=b,f.style.top=k+"px",f.style.bottom="",c.isTopdown=!0),f.style.display="",this.renderer.$textLayer.checkForSizeChanges();var l=a.left;l+f.offsetWidth>h&&(l=h-f.offsetWidth),f.style.left=l+"px",this._signal("show"),e=null,c.isOpen=!0},c.getTextLeftOffset=function(){return this.$borderSize+this.renderer.$padding+this.$imageSize},c.$imageSize=0,c.$borderSize=1,c};i.importCssString(".ace_editor.ace_autocomplete .ace_marker-layer .ace_active-line {    background-color: #CAD6FA;    z-index: 1;}.ace_editor.ace_autocomplete .ace_line-hover {    border: 1px solid #abbffe;    margin-top: -1px;    background: rgba(233,233,253,0.4);}.ace_editor.ace_autocomplete .ace_line-hover {    position: absolute;    z-index: 2;}.ace_editor.ace_autocomplete .ace_scroller {   background: none;   border: none;   box-shadow: none;}.ace_rightAlignedText {    color: gray;    display: inline-block;    position: absolute;    right: 4px;    text-align: right;    z-index: -1;}.ace_editor.ace_autocomplete .ace_completion-highlight{    color: #000;    text-shadow: 0 0 0.01em;}.ace_editor.ace_autocomplete {    width: 280px;    z-index: 200000;    background: #fbfbfb;    color: #444;    border: 1px lightgray solid;    position: fixed;    box-shadow: 2px 3px 5px rgba(0,0,0,.2);    line-height: 1.4;}"),b.AcePopup=k}),ace.define("ace/autocomplete/util",["require","exports","module"],function(a,b,c){"use strict";b.parForEach=function(a,b,c){var d=0,e=a.length;0===e&&c();for(var f=0;e>f;f++)b(a[f],function(a,b){d++,d===e&&c(a,b)})};var d=/[a-zA-Z_0-9\$\-\u00A2-\uFFFF]/;b.retrievePrecedingIdentifier=function(a,b,c){c=c||d;for(var e=[],f=b-1;f>=0&&c.test(a[f]);f--)e.push(a[f]);return e.reverse().join("")},b.retrieveFollowingIdentifier=function(a,b,c){c=c||d;for(var e=[],f=b;f<a.length&&c.test(a[f]);f++)e.push(a[f]);return e}}),ace.define("ace/autocomplete",["require","exports","module","ace/keyboard/hash_handler","ace/autocomplete/popup","ace/autocomplete/util","ace/lib/event","ace/lib/lang","ace/lib/dom","ace/snippets"],function(a,b,c){"use strict";var d=a("./keyboard/hash_handler").HashHandler,e=a("./autocomplete/popup").AcePopup,f=a("./autocomplete/util"),g=(a("./lib/event"),a("./lib/lang")),h=a("./lib/dom"),i=a("./snippets").snippetManager,j=function(){this.autoInsert=!1,this.autoSelect=!0,this.exactMatch=!1,this.gatherCompletionsId=0,this.keyboardHandler=new d,this.keyboardHandler.bindKeys(this.commands),this.blurListener=this.blurListener.bind(this),this.changeListener=this.changeListener.bind(this),this.mousedownListener=this.mousedownListener.bind(this),this.mousewheelListener=this.mousewheelListener.bind(this),this.changeTimer=g.delayedCall(function(){this.updateCompletions(!0)}.bind(this)),this.tooltipTimer=g.delayedCall(this.updateDocTooltip.bind(this),50)};(function(){this.$init=function(){return this.popup=new e(document.body||document.documentElement),this.popup.on("click",function(a){this.insertMatch(),a.stop()}.bind(this)),this.popup.focus=this.editor.focus.bind(this.editor),this.popup.on("show",this.tooltipTimer.bind(null,null)),this.popup.on("select",this.tooltipTimer.bind(null,null)),this.popup.on("changeHoverMarker",this.tooltipTimer.bind(null,null)),this.popup},this.getPopup=function(){return this.popup||this.$init()},this.openPopup=function(a,b,c){this.popup||this.$init(),this.popup.setData(this.completions.filtered),a.keyBinding.addKeyboardHandler(this.keyboardHandler);var d=a.renderer;if(this.popup.setRow(this.autoSelect?0:-1),c)c&&!b&&this.detach();else{this.popup.setTheme(a.getTheme()),this.popup.setFontSize(a.getFontSize());var e=d.layerConfig.lineHeight,f=d.$cursorLayer.getPixelPosition(this.base,!0);f.left-=this.popup.getTextLeftOffset();var g=a.container.getBoundingClientRect();f.top+=g.top-d.layerConfig.offset,f.left+=g.left-a.renderer.scrollLeft,f.left+=d.$gutterLayer.gutterWidth,this.popup.show(f,e)}},this.detach=function(){this.editor.keyBinding.removeKeyboardHandler(this.keyboardHandler),this.editor.off("changeSelection",this.changeListener),this.editor.off("blur",this.blurListener),this.editor.off("mousedown",this.mousedownListener),this.editor.off("mousewheel",this.mousewheelListener),this.changeTimer.cancel(),this.hideDocTooltip(),this.gatherCompletionsId+=1,this.popup&&this.popup.isOpen&&this.popup.hide(),this.base&&this.base.detach(),this.activated=!1,this.completions=this.base=null},this.changeListener=function(a){var b=this.editor.selection.lead;(b.row!=this.base.row||b.column<this.base.column)&&this.detach(),this.activated?this.changeTimer.schedule():this.detach()},this.blurListener=function(a){var b=document.activeElement,c=this.editor.textInput.getElement();b==c||this.popup&&b.parentNode==this.popup.container||b==this.tooltipNode||a.relatedTarget==this.tooltipNode||a.relatedTarget==c||this.detach()},this.mousedownListener=function(a){this.detach()},this.mousewheelListener=function(a){this.detach()},this.goTo=function(a){var b=this.popup.getRow(),c=this.popup.session.getLength()-1;switch(a){case"up":b=0>=b?c:b-1;break;case"down":b=b>=c?-1:b+1;break;case"start":b=0;break;case"end":b=c}this.popup.setRow(b)},this.insertMatch=function(a){if(a||(a=this.popup.getData(this.popup.getRow())),!a)return!1;if(a.completer&&a.completer.insertMatch)a.completer.insertMatch(this.editor,a);else{if(this.completions.filterText)for(var b,c=this.editor.selection.getAllRanges(),d=0;b=c[d];d++)b.start.column-=this.completions.filterText.length,this.editor.session.remove(b);a.snippet?i.insertSnippet(this.editor,a.snippet):this.editor.execCommand("insertstring",a.value||a)}this.detach()},this.commands={Up:function(a){a.completer.goTo("up")},Down:function(a){a.completer.goTo("down")},"Ctrl-Up|Ctrl-Home":function(a){a.completer.goTo("start")},"Ctrl-Down|Ctrl-End":function(a){a.completer.goTo("end")},Esc:function(a){a.completer.detach()},Return:function(a){return a.completer.insertMatch()},"Shift-Return":function(a){a.completer.insertMatch(!0)},Tab:function(a){var b=a.completer.insertMatch();return b||a.tabstopManager?b:void a.completer.goTo("down")},PageUp:function(a){a.completer.popup.gotoPageUp()},PageDown:function(a){a.completer.popup.gotoPageDown()}},this.gatherCompletions=function(a,b){var c=a.getSession(),d=a.getCursorPosition(),e=c.getLine(d.row),g=f.retrievePrecedingIdentifier(e,d.column);this.base=c.doc.createAnchor(d.row,d.column-g.length),this.base.$insertRight=!0;var h=[],i=a.completers.length;return a.completers.forEach(function(e,j){e.getCompletions(a,c,d,g,function(d,e){d||(h=h.concat(e));var g=a.getCursorPosition(),j=c.getLine(g.row);b(null,{prefix:f.retrievePrecedingIdentifier(j,g.column,e[0]&&e[0].identifierRegex),matches:h,finished:0===--i})})}),!0},this.showPopup=function(a){this.editor&&this.detach(),this.activated=!0,this.editor=a,a.completer!=this&&(a.completer&&a.completer.detach(),a.completer=this),a.on("changeSelection",this.changeListener),a.on("blur",this.blurListener),a.on("mousedown",this.mousedownListener),a.on("mousewheel",this.mousewheelListener),this.updateCompletions()},this.updateCompletions=function(a){if(a&&this.base&&this.completions){var b=this.editor.getCursorPosition(),c=this.editor.session.getTextRange({start:this.base,end:b});if(c==this.completions.filterText)return;return this.completions.setFilter(c),this.completions.filtered.length&&(1!=this.completions.filtered.length||this.completions.filtered[0].value!=c||this.completions.filtered[0].snippet)?void this.openPopup(this.editor,c,a):this.detach()}var d=this.gatherCompletionsId;this.gatherCompletions(this.editor,function(b,c){var e=function(){return c.finished?this.detach():void 0}.bind(this),f=c.prefix,g=c&&c.matches;if(!g||!g.length)return e();if(0===f.indexOf(c.prefix)&&d==this.gatherCompletionsId){this.completions=new k(g),this.exactMatch&&(this.completions.exactMatch=!0),this.completions.setFilter(f);var h=this.completions.filtered;return h.length&&(1!=h.length||h[0].value!=f||h[0].snippet)?this.autoInsert&&1==h.length&&c.finished?this.insertMatch(h[0]):void this.openPopup(this.editor,f,a):e()}}.bind(this))},this.cancelContextMenu=function(){this.editor.$mouseHandler.cancelContextMenu()},this.updateDocTooltip=function(){var a=this.popup,b=a.data,c=b&&(b[a.getHoveredRow()]||b[a.getRow()]),d=null;return c&&this.editor&&this.popup.isOpen?(this.editor.completers.some(function(a){return a.getDocTooltip&&(d=a.getDocTooltip(c)),d}),d||(d=c),"string"==typeof d&&(d={docText:d}),d&&(d.docHTML||d.docText)?void this.showDocTooltip(d):this.hideDocTooltip()):this.hideDocTooltip()},this.showDocTooltip=function(a){this.tooltipNode||(this.tooltipNode=h.createElement("div"),this.tooltipNode.className="ace_tooltip ace_doc-tooltip",this.tooltipNode.style.margin=0,this.tooltipNode.style.pointerEvents="auto",this.tooltipNode.tabIndex=-1,this.tooltipNode.onblur=this.blurListener.bind(this));var b=this.tooltipNode;a.docHTML?b.innerHTML=a.docHTML:a.docText&&(b.textContent=a.docText),b.parentNode||document.body.appendChild(b);var c=this.popup,d=c.container.getBoundingClientRect();b.style.top=c.container.style.top,b.style.bottom=c.container.style.bottom,window.innerWidth-d.right<320?(b.style.right=window.innerWidth-d.left+"px",b.style.left=""):(b.style.left=d.right+1+"px",b.style.right=""),b.style.display="block"},this.hideDocTooltip=function(){if(this.tooltipTimer.cancel(),this.tooltipNode){var a=this.tooltipNode;this.editor.isFocused()||document.activeElement!=a||this.editor.focus(),this.tooltipNode=null,a.parentNode&&a.parentNode.removeChild(a)}}}).call(j.prototype),j.startCommand={name:"startAutocomplete",exec:function(a){a.completer||(a.completer=new j),a.completer.autoInsert=!1,a.completer.autoSelect=!0,a.completer.showPopup(a),a.completer.cancelContextMenu()},bindKey:"Ctrl-Space|Ctrl-Shift-Space|Alt-Space"};var k=function(a,b,c){this.all=a,this.filtered=a,this.filterText=b||"",this.exactMatch=!1};(function(){this.setFilter=function(a){if(a.length>this.filterText&&0===a.lastIndexOf(this.filterText,0))var b=this.filtered;else var b=this.all;this.filterText=a,b=this.filterCompletions(b,this.filterText),b=b.sort(function(a,b){return b.exactMatch-a.exactMatch||b.score-a.score});var c=null;b=b.filter(function(a){var b=a.snippet||a.caption||a.value;return b===c?!1:(c=b,!0)}),this.filtered=b},this.filterCompletions=function(a,b){var c=[],d=b.toUpperCase(),e=b.toLowerCase();a:for(var f,g=0;f=a[g];g++){var h=f.value||f.caption||f.snippet;if(h){var i,j,k=-1,l=0,m=0;if(this.exactMatch){if(b!==h.substr(0,b.length))continue a}else for(var n=0;n<b.length;n++){var o=h.indexOf(e[n],k+1),p=h.indexOf(d[n],k+1);if(i=o>=0&&(0>p||p>o)?o:p,0>i)continue a;j=i-k-1,j>0&&(-1===k&&(m+=10),m+=j),l|=1<<i,k=i}f.matchMask=l,f.exactMatch=m?0:1,f.score=(f.score||0)-m,c.push(f)}}return c}}).call(k.prototype),b.Autocomplete=j,b.FilteredList=k}),ace.define("ace/tern/tern_server",["require","exports","module","ace/range","ace/lib/dom"],function(require,exports,module){"use strict";function resolveFilePath(a,b,c){a.options.resolveFilePath?a.options.resolveFilePath(b,c):c(b)}function getFile(a,b,c){var d=a.docs[b];d?c(docValue(a,d)):a.options.getFile?a.options.getFile(b,c):c(null)}function findDoc(a,b,c){for(var d in a.docs){var e=a.docs[d];if(e.doc==b)return e}if(!c)for(var f=0;;++f)if(d="[doc"+(f||"")+"]",!a.docs[d]){c=d;break}return a.addDoc(c,b)}function toTernLoc(a){return"undefined"!=typeof a.row?{line:a.row,ch:a.column}:a}function toAceLoc(a){return a.line?{row:a.line,column:a.ch}:a}function buildRequest(a,b,c,d,e){var f=[],g=0,h=!c.fullDocs;if(h||delete c.fullDocs,"string"==typeof c&&(c={type:c}),c.lineCharPositions=!0,null==c.end){var i=b.doc.getSelectionRange();c.end=toTernLoc(d||i.end),i.start!=i.end&&(c.start=toTernLoc(i.start))}var j=c.start||c.end;if(b.changed)if(!e&&b.doc.session.getLength()>bigDoc&&h!==!1&&b.changed.to-b.changed.from<100&&b.changed.from<=j.line&&b.changed.to>c.end.line){f.push(getFragmentAround(b,j,c.end)),c.file="#0";var g=f[0].offsetLines;null!=c.start&&(c.start=Pos(c.start.line- -g,c.start.ch)),c.end=Pos(c.end.line-g,c.end.ch)}else f.push({type:"full",
name:b.name,text:docValue(a,b)}),c.file=b.name,b.changed=null;else c.file=b.name;for(var k in a.docs){var l=a.docs[k];l.changed&&l!=b&&(f.push({type:"full",name:l.name,text:docValue(a,l)}),l.changed=null)}return{query:c,files:f,timeout:a.queryTimeout}}function getFragmentAround(a,b,c){for(var d,e=a.doc,f=null,g=null,h=e.session.$tabSize,i=b.line-1,j=Math.max(0,i-50);i>=j;--i){var k=e.session.getLine(i),l=k.search(/\bfunction\b/);if(!(0>l)){var m=countColumn(k,null,h);null!=f&&m>=f||(f=m,g=i)}}null==g&&(g=j);var n=Math.min(e.session.getLength()-1,c.line+20);if(null==f||f==countColumn(e.session.getLine(b.line),null,h))d=n;else for(d=c.line+1;n>d;++d){var m=countColumn(e.session.getLine(d),null,h);if(f>=m)break}var o=Pos(g,0);return{type:"part",name:a.name,offsetLines:o.line,text:e.session.getTextRange({start:toAceLoc(o),end:toAceLoc(Pos(d,0))})}}function countColumn(a,b,c,d,e){null==b&&(b=a.search(/[^\s\u00a0]/),-1==b&&(b=a.length));for(var f=d||0,g=e||0;b>f;++f)"	"==a.charAt(f)?g+=c-g%c:++g;return g}function docValue(a,b){var c=b.doc.getValue();return a.options.fileFilter&&(c=a.options.fileFilter(c,b.name,b.doc)),c}function typeToIcon(a){var b;return b="?"==a?"unknown":"number"==a||"string"==a||"bool"==a?a:/^fn\(/.test(a)?"fn":/^\[/.test(a)?"array":"object",cls+"completion "+cls+"completion-"+b}function getCompletions(a,b,c,d,e,f){var g=function(){try{var b=a.lastAutoCompleteFireTime;if(!b)return!1;var c=(new Date).getTime()-b;if(1e3>c)return!0}catch(d){showError({msg:"autoCompleteFiredTwiceInThreshold",err:d})}return!1},h=g();if(!h){var i=getCurrentToken(b);i&&i.type&&-1!==i.type.indexOf("comment")&&(h=!0)}var j="";debugCompletions&&(j=Math.random().toString(36).slice(2)),a.request(b,{type:"completions",types:!0,origins:!0,docs:!0,filter:!1,omitObjectPrototype:!1,sort:!1,includeKeywords:!0,guess:!0,expandWordForward:!0},function(g,i){function j(){return b.popupSelectBound?!1:b.completer.popup?(b.completer.popup.on("select",k),b.completer.popup.on("hide",function(){closeAllTips()}),k(),void(b.popupSelectBound=!0)):void setTimeout(j,100)}function k(){closeAllTips();var a=b.completer.popup.getData(b.completer.popup.getRow());if(a&&a.doc){var c=b.completer.popup.renderer.getContainerElement();u=makeTooltip(c.getBoundingClientRect().right+window.pageXOffset,c.getBoundingClientRect().top+window.pageYOffset,createInfoDataTip(a,!0),b),u.className+=" "+cls+"hint-doc"}}if(g)return showError(a,b,g);var l=i.completions.map(function(a){return{iconClass:" "+(a.guess?cls+"guess":typeToIcon(a.type)),doc:a.doc,type:a.type,caption:a.name,value:a.name,score:99999,meta:a.origin?a.origin.replace(/^.*[\\\/]/,""):"tern"}}),m=[];if(b.getOption("enableBasicAutocompletion")===!0)try{m=b.session.$mode.getCompletions()}catch(n){}if((h||0===l.length)&&a.aceTextCompletor){var o=[];try{a.aceTextCompletor.getCompletions(b,c,d,e,function(a,b){o=b.map(function(a){return{doc:a.doc,type:a.type,caption:a.caption,value:a.value,meta:"localText"}});for(var c=function(a,b){if(a=a.toLowerCase().trim(),a.length<2)return!0;for(var c=!1,d=0;d<m.length;d++)if(m[d].value.toString().toLowerCase()==a){c=!0;break}return c},d=0;d<o.length;d++){var e=o[d];c(e.value)||m.push(e)}})}catch(n){showError(a,b,{msg:"ace text completor error",err:n})}}if(m.length>0){for(var p=l.slice(),q=0;q<m.length;q++){for(var r=m[q],s=!1,t=0;t<l.length;t++)if(l[t].value.toString()===r.value.toString()){s=!0;break}s||p.push(r)}l=p.slice()}f(null,l);var u=null;j()||k();try{a.lastAutoCompleteFireTime=(new Date).getTime()}catch(n){showError(a,b,{msg:"error with last autoCompleteFireTime ",err:n})}})}function showType(a,b,c,d){if(d){if(b.completer&&b.completer.popup&&b.completer.popup.isOpen)return;if(!isOnFunctionCall(b))return}else if(!inJavascriptMode(b))return;var e=function(f,g,h){var i="";if(f){if(d)return;return showError(a,b,f)}if(a.options.typeTip)i=a.options.typeTip(g);else{if(d){if(g.hasOwnProperty("guess")&&g.guess===!0)return;if("?"==g.type||"string"==g.type||"number"==g.type||"bool"==g.type||"date"==g.type||"fn(document: ?)"==g.type||"fn()"==g.type)return}if(g.hasOwnProperty("type")){if("?"==g.type)return void(i=tempTooltip(b,elFromString("<span>?</span>"),1e3));if(g.type.toString().length>1&&"fn"!==g.type.toString().substr(0,2)){var j=function(a,b){e(a,b,g)};return void a.request(b,"definition",j,c,!1,null)}}else h&&h.hasOwnProperty("type")&&(g.type=h.type,g.name=h.name,g.exprName=h.exprName)}i=createInfoDataTip(g,!0),setTimeout(function(){var a=getCusorPosForTooltip(b);makeTooltip(a.left,a.top,i,b,!0)},10)};a.request(b,"type",e,c,!d)}function createInfoDataTip(a,b,c){var d=elt("span",null),e=a.doc,f=a.params||parseJsDocParams(e);if(b){var g=a.fnArgs?a.fnArgs:a.type?parseFnType(a.type):null;if(g){var h=function(a,b){if(null===f)return null;if(!a.name)return null;for(var c=[],d=0;d<f.length;d++)if(b===!0)f[d].parentName.toLowerCase().trim()===a.name.toLowerCase().trim()&&c.push(f[d]);else if(f[d].name.toLowerCase().trim()===a.name.toLowerCase().trim())return f[d];return b===!0?c:null},i=function(a){var b=a.name;return a.optional===!0&&(b=a.defaultValue?"["+b+"="+a.defaultValue+"]":"["+b+"]"),b},j=0===f.length||!isNaN(parseInt(c)),k="";k+=htmlEncode(a.exprName||a.name||"fn"),k+="(";for(var l=null,m=[],n=0;n<g.args.length;n++){var o="",p=isNaN(parseInt(c))?!1:n===c,q=g.args[n],r=q.name||"?";if(r.length>1&&"?"===r.substr(r.length-1)&&(r=r.substr(0,r.length-1),q.name=r),j){var s=h(q,!1),t=h(q,!0),u=q.type,v=!1,w="";if(null!==s&&(r=s.name,s.type&&(u=s.type),p&&(l=s),v=s.optional,w=s.defaultValue.trim()),t&&t.length>0){p&&(m=t),u="{";for(var x=0;x<t.length;x++)u+=t[x].name,x+1!==t.length&&t.length>1&&(u+=", ");u+="}"}o+=u?'<span class="'+cls+'type">'+htmlEncode(u)+"</span> ":"",o+='<span class="'+cls+(p?"farg-current":"farg")+'">'+(htmlEncode(r)||"?")+"</span>",""!==w&&(o+='<span class="'+cls+'jsdoc-param-defaultValue">='+htmlEncode(w)+"</span>"),v&&(o='<span class="'+cls+'jsdoc-param-optionalWrapper"><span class="'+cls+'farg-optionalBracket">[</span>'+o+'<span class="'+cls+'jsdoc-param-optionalBracket">]</span></span>')}else o+=htmlEncode(r);n>0&&(o=", "+o),k+=o}if(k+=")",g.rettype){for(var y=g.rettype,z=y.replace(/^\[+/g,"").replace(/\]+$/g,"");"["==y.charAt(0)&&"]"==y.charAt(y.length-1);)z+="[]",y=y.substring(1,y.length-1);k+=j?' -> <span class="'+cls+'type">'+htmlEncode(z)+"</span>":" -> "+htmlEncode(z)}if(k='<span class="'+cls+(j?"typeHeader":"typeHeader-simple")+'">'+k+"</span>",j&&(l&&l.description&&(k+='<div class="'+cls+'farg-current-description"><span class="'+cls+'farg-current-name">'+l.name+": </span>"+l.description+"</div>"),m&&m.length>0))for(var n=0;n<m.length;n++){var A=m[n].type?'<span class="'+cls+'type">{'+m[n].type+"} </span>":"";k+='<div class="'+cls+'farg-current-description">'+A+'<span class="'+cls+'farg-current-name">'+i(m[n])+": </span>"+m[n].description+"</div>"}d.appendChild(elFromString(k))}}if(isNaN(parseInt(c))){if(a.doc){var B=function(a,b){if(0===b.length)return a;a=a.replace(/@param/gi,"@param");for(var c=a.substr(0,a.indexOf("@param"));-1!==a.indexOf("@param");)a=a.substring(a.indexOf("@param")+6);a=-1!==a.indexOf("@")?a.substr(a.indexOf("@")):"";for(var d="",e=0;e<b.length;e++){if(d+="<div>",d+=""===b[e].parentName.trim()?' <span class="'+cls+'jsdoc-tag">@param</span> ':'<span class="'+cls+'jsdoc-tag-param-child">&nbsp;</span> ',d+=""===b[e].type.trim()?"":'<span class="'+cls+'type">{'+b[e].type+"}</span> ",""!==b[e].name.trim()){var f=b[e].name.trim();""!==b[e].parentName.trim()&&(f=b[e].parentName.trim()+"."+f);var g='<span class="'+cls+'jsdoc-param-name">'+f+"</span>";""!==b[e].defaultValue.trim()&&(g+='<span class="'+cls+'jsdoc-param-defaultValue">='+b[e].defaultValue+"</span>"),b[e].optional&&(g='<span class="'+cls+'jsdoc-param-optionalWrapper"><span class="'+cls+'farg-optionalBracket">[</span>'+g+'<span class="'+cls+'jsdoc-param-optionalBracket">]</span></span>'),d+=g}d+=""===b[e].description.trim()?"":' - <span class="'+cls+'jsdoc-param-description">'+b[e].description+"</span>",d+="</div>"}return""!==d&&(a='<span class="'+cls+'jsdoc-param-wrapper">'+d+"</span>"+a),c+a},C=function(a){try{a=" "+a+" ";for(var b,c=/ ?@\w{1,50}\s ?/gi;null!==(b=c.exec(a));)b.index===c.lastIndex&&c.lastIndex++,a=a.replace(b[0],' <span class="'+cls+'jsdoc-tag">'+b[0].trim()+"</span> ")}catch(d){showError(ts,editor,d)}return a.trim()},D=function(a){a=" "+a+" ";try{for(var b,c=/\s{[^}]{1,50}}\s/g;null!==(b=c.exec(a));)b.index===c.lastIndex&&c.lastIndex++,a=a.replace(b[0],' <span class="'+cls+'type">'+b[0].trim()+"</span> ")}catch(d){showError(ts,editor,d)}return a.trim()},E=function(a){try{for(var b,c="HTTP_PROTO_PLACEHOLDER",d="HTTPS_PROTO_PLACEHOLDER",e=/\bhttps?:\/\/[^\s<>"`{}|\^\[\]\\]+/gi;null!==(b=e.exec(a));){b.index===e.lastIndex&&e.lastIndex++;var f=b[0].replace(/https/i,d).replace(/http/i,c),g=b[0].replace(new RegExp("https://","i"),"").replace(new RegExp("http://","i"),"");a=a.replace(b[0],'<a class="'+cls+'tooltip-link" href="'+f+'" target="_blank">'+g+" </a>")}a=a.replace(new RegExp(d,"gi"),"https").replace(new RegExp(c,"gi"),"http")}catch(h){showError(ts,editor,h)}return a};"*"===e.substr(0,1)&&(e=e.substr(1)),e=htmlEncode(e.trim()),e=B(e,f),e=C(e),e=D(e),e=E(e),d.appendChild(elFromString(e))}if(a.url){d.appendChild(document.createTextNode(" "));var F=elt("a",null,"[docs]");F.target="_blank",F.href=a.url,d.appendChild(F)}a.origin&&d.appendChild(elt("div",null,elt("em",null,"source: "+a.origin)))}return d}function parseJsDocParams(a){if(!a)return[];a=a.replace(/@param/gi,"@param");for(var b=[];-1!==a.indexOf("@param");){a=a.substring(a.indexOf("@param")+6);for(var c,d=a.indexOf("@"),e=-1===d?a:a.substr(0,d),f={name:"",parentName:"",type:"",description:"",optional:!1,defaultValue:""},g=/\s{[^}]{1,50}}\s/;null!==(c=g.exec(e));)c.index===g.lastIndex&&g.lastIndex++,f.type=c[0],e=e.replace(f.type,"").trim(),f.type=f.type.replace("{","").replace("}","").replace(" ","").trim();if(e=e.trim(),"["===e.substr(0,1)){f.optional=!0;var h=e.indexOf("]");if(-1===h){showError("failed to parse parameter name; Found starting '[' but missing closing ']'");continue}var i=e.substring(0,h+1);if(e=e.replace(i,"").trim(),i=i.replace("[","").replace("]",""),-1!==i.indexOf("=")){var j=i.substr(i.indexOf("=")+1);""===j.trim()?f.defaultValue="undefined":f.defaultValue=j.trim(),f.name=i.substring(0,i.indexOf("=")).trim()}else f.name=i.trim()}else{var k=e.indexOf(" ");-1!==k?(f.name=e.substr(0,k),e=e.substr(k).trim()):(f.name=e,e="")}var l=f.name.indexOf(".");-1!==l&&(f.parentName=f.name.substring(0,l),f.name=f.name.substring(l+1)),e=e.trim(),e.length>0&&(f.description=e.replace("-","").trim()),f.name=htmlEncode(f.name),f.parentName=htmlEncode(f.parentName),f.description=htmlEncode(f.description),f.type=htmlEncode(f.type),f.defaultValue=htmlEncode(f.defaultValue),b.push(f)}return b}function findRefs(a,b,c){inJavascriptMode(b)&&a.request(b,{type:"refs",fullDocs:!0},function(d,e){if(d)return showError(a,b,d);if("function"==typeof c)return void c(e);closeAllTips();var f=document.createElement("div"),g=document.createElement("span");g.textContent=e.name+"("+e.type+")",g.setAttribute("style","font-weight:bold;"),f.appendChild(g);var h=makeTooltip(null,null,f,b,!1,-1);if(!e.refs||0===e.refs.length)return void h.appendChild(elt("div","","No References Found"));var i=document.createElement("div");i.setAttribute("style","font-style:italic; margin-bottom:3px; cursor:help"),i.innerHTML=e.refs.length+" References Found",i.setAttribute("title","Use up and down arrow keys to navigate between references. \n\nPress Esc while focused on the list to close the popup (or use the close button in the top right corner).\n\n This is not guaranteed to find references in other files or references for non-private variables."),f.appendChild(i);var j=document.createElement("select");j.setAttribute("multiple","multiple"),j.addEventListener("change",function(){for(var c,d=findDoc(a,b),e=this,f=0;f<e.options.length;f++)c?e[f].selected=!1:e[f].selected&&(c=e[f],c.style.color="grey");var g=c.getAttribute("data-file"),i={line:c.getAttribute("data-line"),ch:c.getAttribute("data-ch")},j=300,k={name:g};d.name==g&&(k=d,j=50);var l=b.getAnimatedScroll();l&&b.setAnimatedScroll(!1),moveTo(a,d,k,i,null,!0),setTimeout(function(){moveTooltip(h,null,null,b),closeAllTips(h),l&&b.setAnimatedScroll(!0)},j)});for(var k=function(a,b){var c=document.createElement("option");c.setAttribute("data-file",a),c.setAttribute("data-line",b.line),c.setAttribute("data-ch",b.ch),c.text=b.line+1+":"+b.ch+" - "+a,j.appendChild(c)},l=function(){var a=15*j.options.length;a=a>175?175:a,j.style.height=a+"px",h.appendChild(j),j.focus(),j.addEventListener("keydown",function(a){a&&a.keyCode&&27==a.keyCode&&remove(h)})},m=0;m<e.refs.length;m++){var n=e.refs[m];try{k(n.file,n.start),m===e.refs.length-1&&l()}catch(o){}}})}function rename(a,b){findRefs(a,b,function(c){if(!c||0===c.refs.length)return void showError(a,b,"Cannot rename as no references were found for this variable");var d=function(d){a.request(b,{type:"rename",newName:d,fullDocs:!0},function(d,e){return d?showError(a,b,d):void applyChanges(a,e.changes,function(a){var d=makeTooltip(null,null,elt("div","","Replaced "+a.replaced+" references sucessfully"),b,!0),e=elt("div","");e.setAttribute("style","color:red"),a.replaced!=c.refs.length&&(e.textContent=" WARNING! original refs: "+c.refs.length+", replaced refs: "+a.replaced),""!==a.errors&&(e.textContent+=" \n Errors encountered:"+a.errors),""!==e.textContent&&d.appendChild(e)})})},e=makeTooltip(null,null,elt("div","",c.name+": "+c.refs.length+" references found \n (WARNING: this wont work for refs in another file!) \n\n Enter new name:\n"),b,!0),f=elt("input");e.appendChild(f);try{setTimeout(function(){f.focus()},100)}catch(g){}var h=elt("button","");h.textContent="Rename",h.setAttribute("type","button"),h.addEventListener("click",function(){remove(e);var c=f.value;return c&&0!==c.trim().length?void d(c):void showError(a,b,"new name cannot be empty")}),e.appendChild(h)})}function applyChanges(a,b,c){for(var d=ace.require("ace/range").Range,e=Object.create(null),f=0;f<b.length;++f){var g=b[f];(e[g.file]||(e[g.file]=[])).push(g)}var h={replaced:0,status:"",errors:""};for(var i in e){var j=a.docs[i],k=e[i];if(j){k.sort(function(a,b){return cmpPos(b.start,a.start)});for(var f=("*rename"+ ++nextChangeOrig,0);f<k.length;++f)try{var g=k[f];g.start=toAceLoc(g.start),g.end=toAceLoc(g.end),j.doc.session.replace(new d(g.start.row,g.start.column,g.end.row,g.end.column),g.text),h.replaced++}catch(l){h.errors+="\n "+i+" - "+l.toString()}}}"function"==typeof c&&c(h)}function isOnFunctionCall(a){if(!inJavascriptMode(a))return!1;if(somethingIsSelected(a))return!1;if(isInCall(a))return!1;var b=getCurrentToken(a);if(b&&b.start){if(-1!==b.type.indexOf("entity.name.function"))return!1;if(-1!==b.type.indexOf("storage.type"))return!1;var c=a.session.getTokenAt(a.getSelectionRange().end.row,b.start+b.value.length+1);return c&&"("===c.value?!0:!1}}function somethingIsSelected(a){return""!==a.getSession().getTextRange(a.getSelectionRange())}function getCusorPosForTooltip(a){var b=a.renderer.$cursorLayer.getPixelPosition();return b.top=a.renderer.$cursorLayer.cursors[0].offsetTop,b.top+=a.renderer.scroller.getBoundingClientRect().top,b.left+=a.renderer.container.offsetLeft,{left:b.left+45,top:b.top+17}}function getCurrentToken(a){try{var b=a.getSelectionRange().end;return a.session.getTokenAt(b.row,b.column)}catch(c){showError(ts,a,c)}}function getCallPos(a,b){if(!somethingIsSelected(a)&&inJavascriptMode(a)){var c={},d=b||a.getSelectionRange().start;d=toAceLoc(d);for(var e=d.row,f=d.column,g=Math.max(0,e-6),h="",i=0,j=[],k=e;k>=g;k--){var l=a.session.getLine(k);k===e&&(l=l.substr(0,f));for(var m=l.length;m>=0;m--)if(h=l.substr(m,1),"}"===h||")"===h||"]"===h)i+=1;else if("{"===h||"("===h||"["===h){if(!(i>0)){if("("===h){var n=l.substr(0,m);if(!n.length)break;if(" "===n.substr(n.length-1))break;var o=n.split(" ").reverse()[1];if(o&&"function"===o.toLowerCase())break;var p=a.session.getTokenAt(k,m);if(p&&(-1!==p.type.toString().indexOf("comment")||"keyword"===p.type||"storage.type"===p.type))break;c={line:k,ch:m};break}break}i-=1}else","===h&&0===i&&j.push({line:k,ch:m})}if(c.hasOwnProperty("line")){for(var q=0,r=0;r<j.length;r++){var s=j[r];(s.line===c.line&&s.ch>c.ch||s.line>c.line)&&(q+=1)}return{start:toTernLoc(c),argpos:q}}}}function isInCall(a,b){var c=getCallPos(a,b);return c?!0:!1}function updateArgHints(a,b){function c(){a.request(b,{type:"type",preferFunction:!0,end:e},function(c,d){return c&&-1===c.toString().toLowerCase().indexOf("no expression at")&&-1===c.toString().toLowerCase().indexOf("no type found at")?showError(a,b,c):void(!c&&d.type&&/^fn\(/.test(d.type)&&(a.cachedArgHints={start:e,type:parseFnType(d.type),name:d.exprName||d.name||"fn",guess:d.guess,doc:b,comments:d.doc},showArgHints(a,b,f)))})}clearTimeout(debounce_updateArgHints),closeArgHints(a);var d=getCallPos(b);if(d){var e=d.start,f=d.argpos,g=a.cachedArgHints;return g&&g.doc==b&&0===cmpPos(e,g.start)?showArgHints(a,b,f):void(debounce_updateArgHints=setTimeout(c,500))}}function showArgHints(a,b,c){closeArgHints(a);var d=a.cachedArgHints;d.type,d.comments;if(!d.hasOwnProperty("params"))if(d.comments){var e=parseJsDocParams(d.comments);e&&0!==e.length?d.params=e:d.params=null}else d.params=null;var f=getCusorPosForTooltip(b),g={name:d.name,guess:d.guess,fnArgs:d.type,doc:d.comments,params:d.params},h=createInfoDataTip(g,!0,c);a.activeArgHints=makeTooltip(f.left,f.top,h,b,!0)}function parseFnType(a){function b(b){for(var c=0,e=d;;){var f=a.charAt(d);if(b.test(f)&&!c)return a.slice(e,d);/[{\[\(]/.test(f)?++c:/[}\]\)]/.test(f)&&--c,++d}}if("fn"!==a.substring(0,2))return null;if(-1===a.indexOf("("))return null;var c=[],d=3;if(")"!=a.charAt(d))for(;;){var e=a.slice(d).match(/^([^, \(\[\{]+): /);if(e&&(d+=e[0].length,e=e[1]),c.push({name:e,type:b(/[\),]/)}),")"==a.charAt(d))break;d+=2}var f=a.slice(d).match(/^\) -> (.*)$/);return{args:c,rettype:f&&f[1]}}function htmlEncode(a){var b={"<":"&lt;",">":"&gt;"};return String(a).replace(/[<>]/g,function(a){return a?b[a]:""})}function cmpPos(a,b){return a=toTernLoc(a),b=toTernLoc(b),a.line-b.line||a.ch-b.ch}function dialog(a,b,c){alert("need to implment dialog")}function elFromString(a){var b=document.createDocumentFragment(),c=document.createElement("span");for(c.innerHTML=a;c.firstChild;)b.appendChild(c.firstChild);return b}function elt(a,b){var c=document.createElement(a);b&&(c.className=b);for(var d=2;d<arguments.length;++d){var e=arguments[d];"string"==typeof e&&(e=document.createTextNode(e)),c.appendChild(e)}return c}function closeAllTips(a){var b=document.querySelectorAll("."+cls+"tooltip");if(b.length>0)for(var c=0;c<b.length;c++)a&&b[c]==a||remove(b[c])}function tempTooltip(a,b,c){c||(c=3e3);var d=getCusorPosForTooltip(a);return makeTooltip(d.left,d.top,b,a,!0,c)}function makeTooltip(a,b,c,d,e,f){if(null===a||null===b){var g=getCusorPosForTooltip(d);a=g.left,b=g.top}var h=elt("div",cls+"tooltip",c);h.style.left=a+"px",h.style.top=b+"px",document.body.appendChild(h);var i=document.createElement("a");if(i.setAttribute("title","close"),i.setAttribute("class",cls+"tooltip-boxclose"),i.addEventListener("click",function(){remove(h)}),h.appendChild(i),e===!0){if(!d)throw Error("tern.makeTooltip called with closeOnCursorActivity=true but editor was not passed. Need to pass editor!");var j=function(){h.parentNode&&(remove(h),d.getSession().selection.off("changeCursor",j),d.getSession().off("changeScrollTop",j),d.getSession().off("changeScrollLeft",j))};d.getSession().selection.on("changeCursor",j),d.getSession().on("changeScrollTop",j),d.getSession().on("changeScrollLeft",j)}if(f&&(f=parseInt(f,10),f>100)){var k=function(){if(h.parentNode){fadeOut(h,f);try{d.getSession().selection.off("changeCursor",j),d.getSession().off("changeScrollTop",j),d.getSession().off("changeScrollLeft",j)}catch(a){}}};setTimeout(k,f)}return h}function moveTooltip(a,b,c,d){if(null===b||null===c){var e=getCusorPosForTooltip(d);b=e.left,c=e.top}a.style.left=b+"px",a.style.top=c+"px"}function remove(a){var b=a&&a.parentNode;b&&b.removeChild(a)}function fadeOut(a,b){return b||(b=1100),-1===b?void remove(a):(a.style.opacity="0",void setTimeout(function(){remove(a)},b))}function showError(a,b,c,d){try{var e="",f="",g=function(a){return a&&a.name&&a.stack&&a.message};if(g(c)?(e=c.name+": "+c.message,f=c.stack):c.msg&&c.err?(e=c.msg,g(c.err)&&(e+=": "+c.err.message,f=c.err.stack)):(e=c,f="details not supplied. current stack:\n"+(new Error).stack),!d){var h=elt("span",null,e);h.style.color="red",tempTooltip(b,h)}}catch(i){setTimeout(function(){throw void 0===typeof e&&(e=" (no error passed)"),new Error("tern show error failed."+e+"\n\n fail error: "+i.name+"\n"+i.message+"\n"+i.stack)},0)}}function closeArgHints(a){a.activeArgHints&&(remove(a.activeArgHints),a.activeArgHints=null)}function jumpToDef(a,b){function c(c){var d={type:"definition",variable:c||null},e=findDoc(a,b);a.server.request(buildRequest(a,e,d,null,!0),function(c,d){if(c)return showError(a,b,c);if(!d.file&&d.url)return void window.open(d.url);if(d.file){var f,g=a.docs[d.file];return g&&(f=findContext(g.doc,d))?(a.jumpStack.push({file:e.name,start:toTernLoc(b.getSelectionRange().start),end:toTernLoc(b.getSelectionRange().end)}),void moveTo(a,e,g,f.start,f.end)):void moveTo(a,e,{name:d.file},d.start,d.end)}showError(a,b,"Could not find a definition.")})}c()}function moveTo(a,b,c,d,e,f){if(e=e||d,b!=c)return void(a.options.switchToDoc?(f||closeAllTips(),a.options.switchToDoc(c.name,toAceLoc(d),toAceLoc(e))):showError(a,b.doc,"Need to add editor.ternServer.options.switchToDoc to jump to another document"));var g=toAceLoc(d);b.doc.gotoLine(g.row,g.column||0),b.doc.getSession().unfold(g);var h=b.doc.getSession().getSelection();h.setSelectionRange({start:toAceLoc(d),end:toAceLoc(e)})}function jumpBack(a,b){var c=a.jumpStack.pop(),d=c&&a.docs[c.file];d&&moveTo(a,findDoc(a,b),d,c.start,c.end)}function findContext(a,b){try{var c=b.context.slice(0,b.contextOffset).split("\n"),d=b.start.line-(c.length-1),e=null;e=1==c.length?b.start.ch:a.session.getLine(d).length-c[0].length;for(var f=Pos(d,e),g=a.session.getLine(d).slice(f.ch),h=d+1;h<a.session.getLength()&&g.length<b.context.length;++h)g+="\n"+a.session.getLine(h)}catch(i){}return b}function atInterestingExpression(a){var b=a.getSelectionRange().end,c=a.session.getTokenAt(b.row,b.column);return b=toTernLoc(b),c.start<b.ch&&("comment"==c.type||"string"==c.type)?!1:/\w/.test(a.session.getLine(b.line).slice(Math.max(b.ch-1,0),b.ch+1))}function sendDoc(a,b){a.server.request({files:[{type:"full",name:b.name,text:docValue(a,b)}]},function(a){a||(b.changed=null)})}function inJavascriptMode(a){return"javascript"==getCurrentMode(a)}function getCurrentMode(a){var b=a.session.$mode.$id||"";if(b=b.split("/").pop(),"html"===b||"php"===b){"php"===b&&(b="html");var c=a.getCursorPosition(),d=a.session.getState(c.row);"object"==typeof d&&(d=d[0]),d.substring&&("js-"==d.substring(0,3)?b="javascript":"css-"==d.substring(0,4)?b="css":"php-"==d.substring(0,4)&&(b="php"))}return b}function startsWith(a,b){return a.slice(0,b.length).toUpperCase()==b.toUpperCase()}function trackChange(a,b,c){var d={};d.from=toTernLoc(c.data.range.start),d.to=toTernLoc(c.data.range.end),c.data.hasOwnProperty("text")?d.text=[c.data.text]:d.text=c.data.lines;var e=findDoc(a,b),f=a.cachedArgHints;f&&f.doc==b&&cmpPos(f.start,d.to)<=0&&(a.cachedArgHints=null);var g=e.changed;null===g&&(e.changed=g={from:d.from.line,to:d.from.line});var h=d.from.line+(d.text.length-1);d.from.line<g.to&&(g.to=g.to-(d.to.line-h)),h>=g.to&&(g.to=h+1),g.from>d.from.line&&(g.from=g.from.line),b.session.getLength()>bigDoc&&d.to-g.from>100&&setTimeout(function(){e.changed&&e.changed.to-e.changed.from>100&&sendDoc(a,e)},200)}function loadExplicitVsRefs(a,b){if(b.ternServer&&b.ternServer.enabledAtCurrentLocation(b)){for(var c=window&&window.location&&0===window.location.toString().toLowerCase().indexOf("http"),d="",e=0;e<b.session.getLength();e++){var f=b.session.getLine(e);if("///"!==f.substr(0,3))break;d+="\n"+f}if(""!==d){for(var g,h=/(?!\/\/\/\s*?<reference path=")[^"]*/g,i=[];null!=(g=h.exec(d));){g.index===h.lastIndex&&h.lastIndex++;var j=g[0].replace('"',"");-1===j.toLowerCase().indexOf("reference path")&&""!==j.trim()&&-1===j.toLowerCase().indexOf("/>")&&-1===j.toLowerCase().indexOf("vsdoc")&&i.push(j)}for(var k=document.createElement("span"),l=0,m=0,n=function(a,c){m++;var d=document.createElement("div");d.setAttribute("style","font-size:smaller; font-style:italic; color:"+(c?"red":"gray")),d.textContent=a,k.appendChild(d),l==m&&tempTooltip(b,k)},o=function(d){try{var e=0===d.toLowerCase().indexOf("http");if(e||c){l++;var f=new XMLHttpRequest;f.open("get",d,!0),f.send(),f.onreadystatechange=function(){4==f.readyState&&(200==f.status?(n("adding web reference: "+d),b.ternServer.addDoc(d,f.responseText)):404==f.status?n("error adding web reference (not found): "+d,!0):n("error adding web reference (unknown error, see console): "+d,!0))}}else l++,resolveFilePath(a,d,function(b){getFile(a,b,function(c,d){c||!d?n("error getting file: "+b+"(see console for details)",!0):(a.addDoc(b,d.toString()),n("adding reference: "+b))})})}catch(g){throw g}},e=0;e<i.length;e++){var p=i[e];o(p)}}}}function WorkerServer(a,b){function c(a,b){b&&(a.id=++f,g[f]=b),d.postMessage(a)}var d=b?new b:new Worker(a.options.workerScript),e=function(a){d.postMessage({type:"init",defs:a.options.defs,plugins:a.options.plugins,scripts:a.options.workerDeps})};e(a);var f=0,g={};d.onmessage=function(b){var d=b.data;"getFile"==d.type?getFile(a,d.name,function(a,b){c({type:"getFile",err:String(a),text:b,id:d.id})}):"debug"==d.type||d.id&&g[d.id]&&(g[d.id](d.err,d.body),delete g[d.id])},d.onerror=function(a){for(var b in g)g[b](a);g={}},this.addFile=function(a,b){c({type:"add",name:a,text:b})},this.delFile=function(a){c({type:"del",name:a})},this.request=function(a,b){c({type:"req",body:a},b)},this.setDefs=function(a){c({type:"setDefs",defs:a})},this.restart=function(a){e(a)},this.sendDebug=function(a){c({type:"debug",body:a})}}var TernServer=function(options){var self=this;this.options=options||{};var plugins=this.options.plugins||(this.options.plugins={});if(plugins.hasOwnProperty("doc_comment")||(plugins.doc_comment={}),plugins.doc_comment.hasOwnProperty("fullDocs")||(plugins.doc_comment.fullDocs=!0),this.options.hasOwnProperty("switchToDoc")||(this.options.switchToDoc=function(a,b){}),this.options.hasOwnProperty("defs")||(this.options.defs=["browser","ecma5","screeps"]),this.options.hasOwnProperty("useWorker")||(this.options.useWorker=!0),this.options.useWorker)this.server=new WorkerServer(this,this.options.workerClass);else{if(this.options.defs&&this.options.defs.length>0){for(var tmp=[],i=0;i<this.options.defs.length;i++)tmp.push(eval("def_"+this.options.defs[i]));this.options.defs=tmp}this.server=new tern.Server({getFile:function(a,b){return getFile(self,a,b)},async:!0,defs:this.options.defs,plugins:this.options.plugins})}this.docs=Object.create(null),this.trackChange=function(a,b){trackChange(self,b,a)},this.cachedArgHints=null,this.activeArgHints=null,this.jumpStack=[],this.aceTextCompletor=null,this.lastAutoCompleteFireTime=null,this.queryTimeout=3e3,this.options.queryTimeout&&!isNaN(parseInt(this.options.queryTimeout))&&(this.queryTimeout=parseInt(this.options.queryTimeout))},Pos=function(a,b){return{line:a,ch:b}},cls="Ace-Tern-",bigDoc=250,aceCommands={ternJumpToDef:{name:"ternJumpToDef",exec:function(a){a.ternServer.jumpToDef(a)},bindKey:"Alt-."},ternJumpBack:{name:"ternJumpBack",exec:function(a){a.ternServer.jumpBack(a)},bindKey:"Alt-,"},ternShowType:{name:"ternShowType",exec:function(a){a.ternServer.showType(a)},bindKey:"Ctrl-I"},ternFindRefs:{name:"ternFindRefs",exec:function(a){a.ternServer.findRefs(a)},bindKey:"Ctrl-E"},ternRename:{name:"ternRename",exec:function(a){a.ternServer.rename(a)},bindKey:"Ctrl-Shift-E"},ternRefresh:{name:"ternRefresh",exec:function(a){var b=!1;null!=a.ternServer.refreshDocLastCalled&&(new Date).getTime()-a.ternServer.refreshDocLastCalled<1e3&&(b=!0),a.ternServer.refreshDocLastCalled=(new Date).getTime(),a.ternServer.refreshDoc(a,b)},bindKey:"Alt-R"}},debugCompletions=!1;TernServer.prototype={bindAceKeys:function(a){for(var b in aceCommands){var c=aceCommands[b];a.commands.addCommand(c)}},addDoc:function(a,b){var c={doc:b,name:a,changed:null},d="";return"String"===b.constructor.name?d=b:(d=docValue(this,c),b.on("change",this.trackChange)),this.server.addFile(a,d),this.docs[a]=c},delDoc:function(a){var b=this.docs[a];if(b){try{b.doc.off("change",this.trackChange)}catch(c){}delete this.docs[a],this.server.delFile(a)}},hideDoc:function(a){closeAllTips();var b=this.docs[a];b&&b.changed&&sendDoc(this,b)},refreshDoc:function(a,b){var c=function(b){var c=document.createElement("span");c.setAttribute("style","color:green;"),c.innerHTML=b,tempTooltip(a,c,2e3)};if(b)return this.docChanged(a),void c("Tern fully refreshed (reloaded current doc and all refs)");var d=findDoc(this,a);sendDoc(this,d),c('Tern document refreshed <div style="color:gray; font-size:smaller;">(press hotkey twice in  &lt; 1 second to do a full reload including refs)</div>')},getCompletions:function(a,b,c,d,e){getCompletions(this,a,b,c,d,e)},showType:function(a,b,c){showType(this,a,b,c)},updateArgHints:function(a){updateArgHints(this,a)},jumpToDef:function(a){jumpToDef(this,a)},jumpBack:function(a){jumpBack(this,a)},rename:function(a){rename(this,a)},findRefs:function(a){findRefs(this,a)},request:function(a,b,c,d,e){var f=this,g=findDoc(this,a),h=buildRequest(this,g,b,d,e);this.server.request(h,function(a,d){!a&&f.options.responseFilter&&(d=f.options.responseFilter(g,b,h,a,d)),c(a,d)})},enabledAtCurrentLocation:function(a){return inJavascriptMode(a)},getCallPos:function(a,b){return getCallPos(a,b)},docChanged:function(a){var b=this;for(var c in this.docs)this.delDoc(c);var d=function(c){b.addDoc(c,a),loadExplicitVsRefs(b,a)};this.options.getCurrentFileName?this.options.getCurrentFileName(d):d("current")},restart:function(){this.options.useWorker&&this.server.restart(this)},debug:function(a){a&&this.options.useWorker&&this.server.sendDebug(a)},debugCompletions:function(a){debugCompletions=a?!0:!1}},exports.TernServer=TernServer;var popupSelectBound=!1,nextChangeOrig=0,debounce_updateArgHints=null,dom=require("ace/lib/dom");dom.importCssString(".Ace-Tern-tooltip { border: 1px solid silver; border-radius: 3px; color: #444; padding: 2px 5px; padding-right:15px; font-size: 90%; font-family: monospace; background-color: white; white-space: pre-wrap; max-width: 50em; max-height:30em; overflow-y:auto; position: absolute; z-index: 10; -webkit-box-shadow: 2px 3px 5px rgba(0, 0, 0, .2); -moz-box-shadow: 2px 3px 5px rgba(0, 0, 0, .2); box-shadow: 2px 3px 5px rgba(0, 0, 0, .2); transition: opacity 1s; -moz-transition: opacity 1s; -webkit-transition: opacity 1s; -o-transition: opacity 1s; -ms-transition: opacity 1s; } .Ace-Tern-tooltip-boxclose { position:absolute; top:0; right:3px; color:red; } .Ace-Tern-tooltip-boxclose:hover { background-color:yellow; } .Ace-Tern-tooltip-boxclose:before { content:'×'; cursor:pointer; font-weight:bold; font-size:larger; } .Ace-Tern-completion { padding-left: 12px; position: relative; } .Ace-Tern-completion:before { position: absolute; left: 0; bottom: 0; border-radius: 50%; font-weight: bold; height: 13px; width: 13px; font-size:11px; line-height: 14px; text-align: center; color: white; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; } .Ace-Tern-completion-unknown:before { content:'?'; background: #4bb; } .Ace-Tern-completion-object:before { content:'O'; background: #77c; } .Ace-Tern-completion-fn:before { content:'F'; background: #7c7; } .Ace-Tern-completion-array:before { content:'A'; background: #c66; } .Ace-Tern-completion-number:before { content:'1'; background: #999; } .Ace-Tern-completion-string:before { content:'S'; background: #999; } .Ace-Tern-completion-bool:before { content:'B'; background: #999; } .Ace-Tern-completion-guess { color: #999; } .Ace-Tern-hint-doc { max-width: 35em; } .Ace-Tern-fhint-guess { opacity: .7; } .Ace-Tern-fname { color: black; } .Ace-Tern-farg { color: #70a; } .Ace-Tern-farg-current { color: #70a; font-weight:bold; font-size:larger; text-decoration:underline; } .Ace-Tern-farg-current-description { font-style:italic; margin-top:2px; color:black; } .Ace-Tern-farg-current-name { font-weight:bold; } .Ace-Tern-type { color: #07c; font-size:smaller; } .Ace-Tern-jsdoc-tag { color: #B93A38; text-transform: lowercase; font-size:smaller; font-weight:600; } .Ace-Tern-jsdoc-param-wrapper{ /*background-color: #FFFFE3; padding:3px;*/ } .Ace-Tern-jsdoc-tag-param-child{ display:inline-block; width:0px; } .Ace-Tern-jsdoc-param-optionalWrapper { font-style:italic; } .Ace-Tern-jsdoc-param-optionalBracket { color:grey; font-weight:bold; } .Ace-Tern-jsdoc-param-name { color: #70a; font-weight:bold; } .Ace-Tern-jsdoc-param-defaultValue { color:grey; } .Ace-Tern-jsdoc-param-description { color:black; } .Ace-Tern-typeHeader-simple{ font-size:smaller; font-weight:bold; display:block; font-style:italic; margin-bottom:3px; color:grey; } .Ace-Tern-typeHeader{ display:block; font-style:italic; margin-bottom:3px; } .Ace-Tern-tooltip-link{font-size:smaller; color:blue;} .ace_autocomplete {width: 400px !important;}","ace_tern");
}),ace.define("ace/tern/tern",["require","exports","module","ace/config","ace/snippets","ace/autocomplete/text_completer","ace/autocomplete","ace/tern/tern_server","ace/editor"],function(a,b,c){"use strict";var d=a("../config"),e=a("../snippets").snippetManager,f={getCompletions:function(a,b,c,d,f){var g=e.snippetMap,h=[];e.getActiveScopes(a).forEach(function(a){for(var b=g[a]||[],c=b.length;c--;){var d=b[c],e=d.name||d.tabTrigger;e&&h.push({caption:e,snippet:d.content,meta:d.tabTrigger&&!d.name?d.tabTrigger+"⇥ ":"snippet"})}},this),f(null,h)}},g=a("../autocomplete/text_completer"),h={getCompletions:function(a,b,c,d,e){var f=a.session.getState(c.row),g=b.$mode.getCompletions(f,b,c,d);e(null,g)}},i=[f,g,h];b.setCompleters=function(a){i=a||[]},b.addCompleter=function(a){i.push(a)};var j={name:"expandSnippet",exec:function(a){var b=e.expandWithTab(a);b||a.execCommand("indent")},bindKey:"tab"},k=function(a){var b=a.$id;if(e.files||(e.files={}),l(b),a.$modes)for(var c in a.$modes)k(a.$modes[c])},l=function(a){if(a&&!e.files[a]){var b=a.replace("mode","snippets");e.files[a]={},d.loadModule(b,function(b){b&&(e.files[a]=b,!b.snippets&&b.snippetText&&(b.snippets=e.parseSnippetFile(b.snippetText)),e.register(b.snippets||[],b.scope),b.includeScopes&&(e.snippetMap[b.scope].includeScopes=b.includeScopes,b.includeScopes.forEach(function(a){l("ace/mode/"+a)})))})}},m=a("../autocomplete").Autocomplete;m.startCommand={name:"startAutocomplete",exec:function(a,b){a.completer||(a.completer=new m),a.completers=[],a.$enableSnippets&&a.completers.push(f),a.ternServer&&a.$enableTern&&a.ternServer.enabledAtCurrentLocation(a)?(a.completers.push(a.ternServer),a.ternServer.aceTextCompletor=g):a.$enableBasicAutocompletion&&a.completers.push(g,h),a.completer.showPopup(a),a.completer.cancelContextMenu()},bindKey:"Ctrl-Space|Ctrl-Shift-Space|Alt-Space"};var n,o,p=function(a,b){k(b.session.$mode)},q={},r=a("./tern_server").TernServer,s=function(a){function b(){q.workerScript||(q.workerScript=c),n=new r(q),a()}var c=q.workerScript||d.moduleUrl("worker/tern");if(q.useWorker===!1){var e="ace_tern_files";if(document.getElementById(e))b();else{var f=document.createElement("script");f.setAttribute("id",e),document.head.appendChild(f),f.onload=b,f.setAttribute("src",c)}}else b()},t=null,u=function(a,b){clearTimeout(o),o=setTimeout(function(){t.ternServer.updateArgHints(t)},10)},v=function(a,b){if("insertstring"===a.command.name&&"."===a.args&&a.editor.ternServer&&a.editor.ternServer.enabledAtCurrentLocation(a.editor)){var c=a.editor.getSelectionRange().end,d=a.editor.session.getTokenAt(c.row,c.column);if(d&&"string"!==d.type&&-1===d.type.toString().indexOf("comment")){try{a.editor.ternServer.lastAutoCompleteFireTime=null}catch(e){}a.editor.execCommand("startAutocomplete")}}};i.push(n),b.server=n;var w=a("../editor").Editor;d.defineOptions(w.prototype,"editor",{enableTern:{set:function(a){var b=this;"object"==typeof a&&(q=a,a=!0),a?(t=b,s(function(){b.completers=i,b.ternServer=n,b.commands.addCommand(m.startCommand),b.getSession().selection.on("changeCursor",u),b.commands.on("afterExec",v),n.bindAceKeys(b),q.startedCb&&q.startedCb()})):(delete b.ternServer,b.getSession().selection.off("changeCursor",u),b.commands.off("afterExec",v),b.enableBasicAutocompletion||b.commands.removeCommand(m.startCommand))},value:!1},enableBasicAutocompletion:{set:function(a){a?(this.completers=i,this.commands.addCommand(m.startCommand)):this.$enableTern||this.commands.removeCommand(m.startCommand)},value:!1},enableSnippets:{set:function(a){a?(this.commands.addCommand(j),this.on("changeMode",p),p(null,this)):(this.commands.removeCommand(j),this.off("changeMode",p))},value:!1}})}),function(){ace.require(["ace/tern/tern"],function(){})}();